<div class="container h-full flex flex-col">
    <!-- Breadcrumbs -->
    <div class="flex flex-wrap gap-2 text-sm mb-4">
        <a class="text-text-secondary-light dark:text-text-secondary-dark hover:text-primary transition-colors"
            routerLink="/">Inicio</a>
        <span class="text-text-secondary-light dark:text-text-secondary-dark">/</span>
        <span class="text-text-secondary-light dark:text-text-secondary-dark">Configuración</span>
        <span class="text-text-secondary-light dark:text-text-secondary-dark">/</span>
        <span class="text-text-main-light dark:text-text-main-dark font-medium">Catálogo de Servicios</span>
    </div>

    <!-- Page Heading & Main Action -->
    <div class="flex flex-col sm:flex-row sm:items-end justify-between gap-4 mb-6">
        <div>
            <h1 class="text-3xl md:text-4xl font-black text-text-main-light dark:text-text-main-dark tracking-tight">
                Catálogo de Servicios</h1>
            <p class="text-text-secondary-light dark:text-text-secondary-dark mt-1">Administra especialidades,
                categorías y servicios.</p>
        </div>
        <div class="flex gap-3">
            <button (click)="exportData()"
                class="flex items-center gap-2 px-4 h-10 rounded-lg bg-surface-light dark:bg-surface-dark border border-border-light dark:border-border-dark text-[#111418] dark:text-white text-sm font-bold hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors">
                <span class="material-symbols-outlined text-[20px]">file_download</span>
                <span class="hidden sm:inline">Exportar</span>
            </button>
            <button (click)="createService()"
                class="flex items-center gap-2 bg-primary hover:bg-primary-hover text-white px-5 py-2.5 rounded-lg font-bold shadow-lg shadow-primary/20 transition-all active:scale-95">
                <span class="material-symbols-outlined" style="font-size: 20px;">add</span>
                <span>Nuevo Servicio</span>
            </button>
        </div>
    </div>

    <!-- Filter & Search Section -->
    <div
        class="bg-surface-light dark:bg-surface-dark p-4 rounded-xl border border-[#dbe4e6] dark:border-[#2a3e42] shadow-sm mb-4">
        <div class="flex flex-col md:flex-row gap-4 justify-between items-center">
            <div class="relative flex-1 w-full md:max-w-md">
                <span
                    class="material-symbols-outlined absolute left-3 top-1/2 -translate-y-1/2 text-text-secondary-light dark:text-text-secondary-dark"
                    style="font-size: 20px;">search</span>
                <input
                    class="w-full h-11 pl-10 pr-4 rounded-lg bg-background-light dark:bg-background-dark border border-[#dbe4e6] dark:border-[#2a3e42] text-sm focus:ring-2 focus:ring-primary focus:border-transparent outline-none transition-all"
                    placeholder="Buscar por código o nombre..." type="text" [(ngModel)]="searchQuery"
                    (ngModelChange)="onSearch($event)" />
            </div>

            <!-- Filters -->
            <div class="flex gap-2 w-full md:w-auto overflow-x-auto">
                <select [(ngModel)]="selectedCategoryId" (change)="onFilterChange()"
                    class="h-11 px-3 rounded-lg bg-background-light dark:bg-background-dark border border-[#dbe4e6] dark:border-[#2a3e42] text-sm text-text-main-light dark:text-text-main-dark focus:ring-2 focus:ring-primary outline-none">
                    <option value="">Todas las Categorías</option>
                    <option *ngFor="let cat of categories" [value]="cat.id">{{cat.name}}</option>
                </select>

                <select [(ngModel)]="selectedType" (change)="onFilterChange()"
                    class="h-11 px-3 rounded-lg bg-background-light dark:bg-background-dark border border-[#dbe4e6] dark:border-[#2a3e42] text-sm text-text-main-light dark:text-text-main-dark focus:ring-2 focus:ring-primary outline-none">
                    <option value="">Todos los Tipos</option>
                    <option *ngFor="let type of serviceTypes" [value]="type">{{type}}</option>
                </select>
            </div>
        </div>
    </div>

    <!-- Data Table -->
    <div class="flex-1 min-h-0 flex flex-col">
        <app-custom-table [columns]="columns" [data]="filteredServices" [totalItems]="totalItems" [page]="page"
            [pageSize]="pageSize" [showEdit]="true" [showDelete]="true" [showPagination]="true"
            (pageChange)="onPageChange($event)" (pageSizeChange)="onPageSizeChange($event)"
            (onEdit)="editService($event)" (onDelete)="deleteService($event)" [columnTemplates]="{ price: priceTmpl }">
        </app-custom-table>

        <ng-template #priceTmpl let-item>
            <div class="text-right font-medium">
                {{ item.price | currency:'PYG':'symbol-narrow':'1.0-0' }}
            </div>
        </ng-template>
    </div>
</div>