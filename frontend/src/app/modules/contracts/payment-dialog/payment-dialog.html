<div
    class="flex flex-col bg-background-light dark:bg-background-dark rounded-2xl overflow-hidden shadow-2xl border border-[#dbe4e6] dark:border-[#2a3e42] w-full max-w-md">
    <!-- Header -->
    <div
        class="px-6 py-4 border-b border-[#dbe4e6] dark:border-[#2a3e42] bg-surface-light dark:bg-surface-dark/50 flex justify-between items-center">
        <div class="flex items-center gap-3">
            <div class="size-10 rounded-xl bg-green-500/10 text-green-600 flex items-center justify-center">
                <span class="material-symbols-outlined">payments</span>
            </div>
            <div>
                <h2 class="text-xl font-extra-bold text-text-main-light dark:text-text-main-dark tracking-tight">
                    Registrar Pago</h2>
                <p class="text-xs text-text-secondary-light dark:text-text-secondary-dark">Ingresa los detalles de la
                    transacción.</p>
            </div>
        </div>
        <button (click)="close()"
            class="size-8 rounded-lg flex items-center justify-center hover:bg-surface-white dark:hover:bg-surface-dark text-text-secondary-light transition-all">
            <span class="material-symbols-outlined" style="font-size: 20px;">close</span>
        </button>
    </div>

    <!-- Content -->
    <div class="p-6 flex flex-col gap-6">
        <div class="p-4 rounded-xl bg-primary/5 border border-primary/10 flex justify-between items-center">
            <span class="text-xs font-bold text-primary uppercase tracking-wider">Saldo Pendiente</span>
            <span class="text-lg font-black text-primary">{{ data.balance | currency }}</span>
        </div>

        <form [formGroup]="form" class="flex flex-col gap-5">
            <!-- Amount -->
            <div class="flex flex-col gap-2">
                <label class="text-sm font-bold text-text-main-light dark:text-text-main-dark">Monto a pagar</label>
                <div class="relative">
                    <span class="absolute left-3 top-1/2 -translate-y-1/2 text-text-secondary-light font-bold">₲</span>
                    <input type="number" formControlName="amount"
                        class="w-full h-11 pl-8 pr-4 rounded-xl bg-surface-white dark:bg-surface-dark border border-[#dbe4e6] dark:border-[#2a3e42] text-sm text-text-main-light dark:text-text-main-dark focus:ring-2 focus:ring-primary outline-none transition-all"
                        placeholder="0.00">
                </div>
                <p *ngIf="form.get('amount')?.errors?.['max']" class="text-[10px] text-red-500 font-bold italic">
                    El monto no puede exceder el saldo pendiente.
                </p>
            </div>

            <!-- Payment Method -->
            <div class="flex flex-col gap-2">
                <label class="text-sm font-bold text-text-main-light dark:text-text-main-dark">Método de Pago</label>
                <div class="relative">
                    <select formControlName="method"
                        class="w-full h-11 pl-4 pr-10 rounded-xl bg-surface-white dark:bg-surface-dark border border-[#dbe4e6] dark:border-[#2a3e42] text-sm text-text-main-light dark:text-text-main-dark focus:ring-2 focus:ring-primary outline-none appearance-none cursor-pointer transition-all">
                        <option *ngFor="let method of paymentMethods" [value]="method">{{ method }}</option>
                    </select>
                    <span
                        class="material-symbols-outlined absolute right-3 top-1/2 -translate-y-1/2 text-text-secondary-light pointer-events-none">expand_more</span>
                </div>
            </div>
        </form>
    </div>

    <!-- Actions -->
    <div
        class="px-6 py-4 border-t border-[#dbe4e6] dark:border-[#2a3e42] bg-surface-light dark:bg-surface-dark/50 flex gap-3">
        <button (click)="close()"
            class="flex-1 h-11 rounded-xl border border-[#dbe4e6] dark:border-[#2a3e42] text-sm font-bold text-text-secondary-light hover:bg-surface-white dark:hover:bg-surface-dark transition-all">
            Cancelar
        </button>
        <button [disabled]="form.invalid || isSaving" (click)="save()"
            class="flex-[1.5] h-11 rounded-xl bg-green-600 text-white font-bold text-sm flex items-center justify-center gap-2 hover:bg-green-700 disabled:opacity-50 transition-all shadow-lg shadow-green-200">
            <span *ngIf="!isSaving" class="material-symbols-outlined" style="font-size: 20px;">task_alt</span>
            <span *ngIf="!isSaving">Confirmar Pago</span>
            <span *ngIf="isSaving">Guardando...</span>
        </button>
    </div>
</div>