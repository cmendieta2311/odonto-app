<div class="flex-1 flex flex-col h-full overflow-hidden bg-background-light dark:bg-background-dark relative">
    <!-- Main Content Area -->
    <!-- Main Content Area -->
    <main class="flex-1 overflow-y-auto bg-background-light dark:bg-background-dark p-6 md:p-10 pb-32">
        <div class="max-w-6xl mx-auto flex flex-col gap-6">
            <!-- Header Section inside content -->
            <div class="flex flex-col md:flex-row md:items-center justify-between gap-4 mb-2">
                <div>
                    <div class="flex items-center gap-3 mb-2">
                        <button (click)="cancel()" class="text-text-secondary hover:text-primary transition-colors">
                            <span class="material-symbols-outlined text-lg align-middle">arrow_back</span>
                        </button>
                        <span
                            class="px-2 py-0.5 rounded bg-emerald-100 text-emerald-600 dark:bg-emerald-900/30 dark:text-emerald-400 text-[10px] font-extrabold uppercase tracking-widest">
                            {{ isEditMode ? quote?.status : 'Borrador' }}
                        </span>
                        <span class="text-xs text-text-secondary font-medium">{{ isEditMode ? '#' + quote?.id?.slice(0,
                            8) : 'Nuevo Presupuesto' }}</span>
                    </div>
                    <h2 class="text-3xl font-extrabold text-text-main dark:text-white tracking-tight">{{ isEditMode ?
                        'Editar' : 'Nuevo' }} Presupuesto</h2>
                    <p class="text-text-secondary text-sm mt-1">Cree y gestione el plan de tratamiento detallado para el
                        paciente.</p>
                </div>
                <!-- Header Actions -->
                <div class="flex items-center gap-2" *ngIf="isEditMode">
                    <button type="button" (click)="save(QuoteStatus.REJECTED)" *ngIf="!isReadOnly"
                        class="px-4 py-2 rounded-lg text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20 text-xs font-bold transition-all border border-transparent hover:border-red-200">
                        Rechazar
                    </button>
                    <button type="button" (click)="downloadPdf()" [disabled]="!quote"
                        class="px-4 py-2 rounded-lg bg-surface-light dark:bg-surface-dark border border-gray-200 dark:border-gray-700 text-text-secondary hover:text-primary hover:border-primary text-xs font-bold transition-all flex items-center gap-2">
                        <span class="material-symbols-outlined text-lg">picture_as_pdf</span>
                        Descargar PDF
                    </button>
                </div>
            </div>
            <!-- Top Actions -->
            <div class="flex items-center gap-2">
                <!-- Removed redundant Save Draft button -->
            </div>
        </div>


        <form [formGroup]="form" class="grid grid-cols-1 xl:grid-cols-12 gap-8">
            <!-- Left Column (8 cols) -->
            <div class="xl:col-span-8 flex flex-col gap-6">

                <!-- Patient Section -->
                <section
                    class="bg-surface-light dark:bg-surface-dark rounded-xl p-6 shadow-sm border border-border-light dark:border-border-dark">
                    <div class="flex items-center justify-between mb-5">
                        <h3 class="text-base font-bold flex items-center gap-2 text-text-main dark:text-white">
                            <span class="material-symbols-outlined text-primary">person</span>
                            Información del Paciente
                        </h3>
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <label
                                class="block text-[11px] font-bold text-text-secondary uppercase tracking-wider mb-2">Buscar
                                Paciente</label>
                            <div class="relative group">
                                <input [formControl]="searchControl" type="text"
                                    class="w-full pl-4 pr-10 py-2.5 rounded-lg bg-background-light dark:bg-background-dark border border-border-light dark:border-border-dark focus:ring-1 focus:ring-primary text-sm font-medium text-text-main dark:text-white placeholder-text-secondary/50"
                                    (focus)="searchControl.value && (showPatientDropdown = true)"
                                    (blur)="showPatientDropdown = false" />
                                <span
                                    class="absolute right-3 top-1/2 -translate-y-1/2 text-text-secondary material-symbols-outlined text-lg">search</span>

                                <!-- Patient Dropdown -->
                                <div *ngIf="showPatientDropdown && patients.length > 0 && !isReadOnly"
                                    class="absolute top-full left-0 w-full mt-2 bg-white dark:bg-surface-dark border border-border-light dark:border-border-dark rounded-xl shadow-xl z-50 max-h-60 overflow-y-auto">
                                    <ul class="py-2">
                                        <li *ngFor="let p of patients" (mousedown)="selectPatient(p)"
                                            class="px-4 py-3 hover:bg-gray-50 dark:hover:bg-white/5 cursor-pointer border-b border-gray-50 dark:border-gray-800 last:border-0">
                                            <div class="font-bold text-text-main dark:text-white">{{ p.firstName }}
                                                {{ p.lastName }}</div>
                                            <div class="text-xs text-text-secondary">{{ p.dni }}</div>
                                        </li>
                                    </ul>
                                </div>
                                <div *ngIf="showPatientDropdown && patients.length === 0 && searchControl.value && !isReadOnly"
                                    class="absolute top-full left-0 w-full mt-2 bg-white dark:bg-surface-dark border p-4 text-center rounded-xl shadow-xl z-50">
                                    <span class="text-sm text-text-secondary">No encontrado</span>
                                </div>
                            </div>
                        </div>
                        <div>
                            <label
                                class="block text-[11px] font-bold text-text-secondary uppercase tracking-wider mb-2">Nº
                                Documento</label>
                            <input
                                class="w-full px-4 py-2.5 rounded-lg bg-background-light dark:bg-background-dark border border-border-light dark:border-border-dark text-sm font-medium text-text-main dark:text-white"
                                readonly type="text" [value]="selectedPatient?.dni || '---'" />
                        </div>
                    </div>
                </section>

                <!-- Services Section -->
                <section
                    class="bg-surface-light dark:bg-surface-dark rounded-xl shadow-sm border border-border-light dark:border-border-dark">
                    <div class="p-6 border-b border-border-light dark:border-border-dark">
                        <div class="flex items-center justify-between mb-4">
                            <h3
                                class="text-base font-bold flex items-center gap-2 uppercase tracking-wide text-text-main dark:text-white">
                                <span
                                    class="size-8 rounded-lg bg-primary/10 text-primary flex items-center justify-center">
                                    <span class="material-symbols-outlined text-xl">dentistry</span>
                                </span>
                                Servicios Incluidos
                            </h3>
                            <button type="button" (click)="openCatalog()"
                                class="text-xs font-bold text-primary hover:underline flex items-center gap-1">
                                Ver Catálogo Completo <span
                                    class="material-symbols-outlined text-xs">arrow_forward</span>
                            </button>
                        </div>

                        <!-- Search Service -->
                        <div class="relative mb-6">
                            <span
                                class="absolute left-4 top-1/2 -translate-y-1/2 text-primary/50 material-symbols-outlined text-xl">add_circle</span>
                            <input [formControl]="serviceSearchControl" type="text"
                                placeholder="Buscar servicio por nombre o código..."
                                class="w-full pl-12 pr-4 py-3 bg-background-light dark:bg-background-dark border-none rounded-lg text-text-main dark:text-white text-sm font-medium focus:ring-1 focus:ring-primary placeholder-text-secondary/50"
                                (focus)="serviceSearchControl.value && (showServiceDropdown = true)"
                                (blur)="showServiceDropdown = false" />

                            <!-- Service Dropdown -->
                            <div *ngIf="showServiceDropdown && filteredServices.length > 0"
                                class="absolute top-full left-0 right-0 mt-2 bg-white dark:bg-surface-dark rounded-xl shadow-xl border border-border-light dark:border-border-dark max-h-60 overflow-y-auto z-50">
                                <ul>
                                    <li *ngFor="let s of filteredServices" (mousedown)="addService(s)"
                                        class="px-4 py-3 hover:bg-gray-50 dark:hover:bg-white/5 cursor-pointer flex justify-between items-center border-b border-gray-50 dark:border-gray-800 last:border-0">
                                        <div>
                                            <div class="font-bold text-text-main dark:text-white text-sm">{{s.name}}
                                            </div>
                                            <div class="text-xs text-text-secondary">{{s.code}}</div>
                                        </div>
                                        <div class="font-bold text-emerald-600 dark:text-emerald-400 text-sm">
                                            {{s.price | currency}}</div>
                                    </li>
                                </ul>
                            </div>
                        </div>

                        <!-- Suggested Services -->
                        <div class="flex flex-wrap gap-2 items-center" *ngIf="!isReadOnly">
                            <span
                                class="text-[10px] font-bold text-text-secondary uppercase tracking-wider">Sugeridos:</span>
                            <button type="button" *ngFor="let s of suggestedServices" (click)="addSuggestedService(s)"
                                class="px-2 py-1 bg-emerald-50 dark:bg-emerald-900/20 hover:bg-emerald-100 dark:hover:bg-emerald-900/30 text-emerald-700 dark:text-emerald-400 text-[10px] font-bold rounded border border-emerald-100 dark:border-emerald-800 transition-colors">
                                + {{s.name}}
                            </button>
                        </div>
                    </div>

                    <!-- Table -->
                    <div class="overflow-x-auto">
                        <table class="w-full text-left border-collapse">
                            <thead
                                class="bg-gray-50 dark:bg-gray-800/50 text-[10px] uppercase text-text-secondary font-bold tracking-wider border-b border-border-light dark:border-border-dark">
                                <tr>
                                    <th class="px-6 py-3 w-[40%]">Servicio / Tratamiento</th>
                                    <th class="px-4 py-3 text-center w-[15%]">Cant.</th>
                                    <th class="px-4 py-3 text-right w-[15%]">Precio Unit.</th>
                                    <th class="px-4 py-3 text-center w-[15%]">Desc. %</th>
                                    <th class="px-6 py-3 text-right w-[15%]">Total</th>
                                </tr>
                            </thead>
                            <tbody [formGroup]="form">
                                <ng-container formArrayName="items">
                                    <tr *ngFor="let item of items.controls; let i = index" [formGroupName]="i"
                                        class="border-b border-border-light dark:border-border-dark hover:bg-gray-50/50 dark:hover:bg-white/5 transition-colors group">
                                        <td class="px-6 py-4">
                                            <div class="font-bold text-text-main dark:text-white text-sm">{{
                                                getServiceForIndex(i)?.name }}</div>
                                            <div class="text-xs text-text-secondary">Cód: {{
                                                getServiceForIndex(i)?.code }}</div>
                                        </td>
                                        <td class="px-4 py-4">
                                            <div class="flex justify-center">
                                                <div
                                                    class="composite-focus-container inline-flex items-center bg-background-light dark:bg-background-dark border border-border-light dark:border-border-dark rounded-lg overflow-hidden h-8 w-fit max-w-[100px] focus-within:ring-1 focus-within:ring-primary focus-within:border-primary">
                                                    <button type="button"
                                                        (click)="item.get('quantity')?.setValue((item.get('quantity')?.value || 1) - 1)"
                                                        [disabled]="(item.get('quantity')?.value <= 1) || isReadOnly"
                                                        class="w-8 h-full text-text-secondary hover:text-primary hover:bg-gray-50 dark:hover:bg-white/5 flex items-center justify-center transition-colors disabled:opacity-30 disabled:hover:text-text-secondary disabled:hover:bg-transparent cursor-pointer disabled:cursor-not-allowed border-r border-border-light/50 dark:border-border-dark/50">
                                                        <span
                                                            class="material-symbols-outlined text-[16px] font-bold">remove</span>
                                                    </button>
                                                    <input formControlName="quantity" type="number" min="1"
                                                        class="composite-inner-input w-10 text-center bg-transparent border-none text-xs font-bold focus:ring-0 p-0 appearance-none text-text-main dark:text-white" />
                                                    <button type="button"
                                                        (click)="item.get('quantity')?.setValue((item.get('quantity')?.value || 1) + 1)"
                                                        [disabled]="isReadOnly"
                                                        class="w-8 h-full text-text-secondary hover:text-primary hover:bg-gray-50 dark:hover:bg-white/5 flex items-center justify-center transition-colors cursor-pointer border-l border-border-light/50 dark:border-border-dark/50 disabled:opacity-30 disabled:cursor-not-allowed">
                                                        <span
                                                            class="material-symbols-outlined text-[16px] font-bold">add</span>
                                                    </button>
                                                </div>
                                            </div>
                                        </td>
                                        <td class="px-4 py-4 text-right text-sm text-text-secondary font-medium">
                                            {{ item.get('price')?.value | currency }}
                                        </td>
                                        <td class="px-4 py-4">
                                            <div class="flex justify-center">
                                                <div
                                                    class="composite-focus-container inline-flex items-center bg-background-light dark:bg-background-dark border border-border-light dark:border-border-dark rounded-lg overflow-hidden h-8 px-2 w-20 focus-within:ring-1 focus-within:ring-primary focus-within:border-primary">
                                                    <input formControlName="discount" type="number" min="0" max="100"
                                                        placeholder="0"
                                                        class="composite-inner-input w-full text-right bg-transparent border-none text-xs font-bold focus:ring-0 p-0 text-text-main dark:text-white placeholder-text-secondary/30" />
                                                    <span
                                                        class="text-[10px] font-bold text-text-secondary ml-1">%</span>
                                                </div>
                                            </div>
                                        </td>
                                        <td class="px-6 py-4 text-right">
                                            <span class="text-sm font-bold text-text-main dark:text-white">
                                                {{ (item.get('price')?.value * item.get('quantity')?.value * (1 -
                                                (item.get('discount')?.value || 0)/100)) | currency }}
                                            </span>
                                        </td>
                                        <td class="w-8 text-center">
                                            <button type="button" (click)="removeItem(i)" *ngIf="!isReadOnly"
                                                class="text-text-secondary hover:text-red-500 opacity-0 group-hover:opacity-100 transition-opacity">
                                                <span class="material-symbols-outlined text-lg">delete</span>
                                            </button>
                                        </td>
                                    </tr>
                                </ng-container>
                                <tr *ngIf="items.length === 0">
                                    <td colspan="6" class="py-12 text-center text-text-secondary">
                                        <p class="text-sm">No hay servicios agregados.</p>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </section>

                <!-- Observations -->
                <section
                    class="bg-surface-light dark:bg-surface-dark rounded-xl p-6 shadow-sm border border-border-light dark:border-border-dark">
                    <label
                        class="block text-[11px] font-bold text-text-secondary uppercase tracking-widest mb-3">Observaciones
                        Internas</label>
                    <textarea formControlName="observations"
                        class="w-full p-4 rounded-lg bg-background-light dark:bg-background-dark border border-border-light dark:border-border-dark focus:ring-1 focus:ring-primary text-sm min-h-[100px] resize-none text-text-main dark:text-white"
                        placeholder="Agregar notas sobre el tratamiento, preferencias del paciente, etc..."></textarea>
                </section>
            </div>

            <!-- Right Column (4 cols) -->
            <div class="xl:col-span-4 flex flex-col gap-6">

                <!-- Financing & Summary -->
                <section
                    class="bg-surface-light dark:bg-surface-dark rounded-xl shadow-sm border border-border-light dark:border-border-dark overflow-hidden sticky top-6">
                    <div class="p-6">
                        <div class="flex items-center justify-between mb-6">
                            <h3 class="text-base font-bold flex items-center gap-2 text-text-main dark:text-white">
                                <span class="material-symbols-outlined text-primary">payments</span>
                                Financiación
                            </h3>
                            <label class="relative inline-flex items-center cursor-pointer">
                                <input type="checkbox" formControlName="financingEnabled" class="sr-only peer">
                                <div
                                    class="w-11 h-6 bg-gray-200 peer-focus:outline-none rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-primary">
                                </div>
                            </label>
                        </div>

                        <div class="space-y-5" [class.opacity-50]="!form.get('financingEnabled')?.value"
                            [class.pointer-events-none]="!form.get('financingEnabled')?.value">
                            <div>
                                <label
                                    class="block text-[11px] font-bold text-text-secondary uppercase tracking-wider mb-2">Monto
                                    Entrega Inicial</label>
                                <div class="relative">
                                    <span
                                        class="absolute left-3 top-1/2 -translate-y-1/2 text-text-secondary text-sm font-medium">Gs.</span>
                                    <input [value]="formattedInitialPayment" (input)="onInitialPaymentInput($event)"
                                        class="w-full pl-10 pr-4 py-2.5 rounded-lg bg-background-light dark:bg-background-dark border border-border-light dark:border-border-dark focus:ring-1 focus:ring-primary text-sm font-bold text-text-main dark:text-white"
                                        type="text" />
                                </div>
                            </div>

                            <div>
                                <label
                                    class="block text-[11px] font-bold text-text-secondary uppercase tracking-wider mb-2">Cantidad
                                    de Cuotas ({{minInstallments}}-{{maxInstallments}})</label>
                                <div
                                    class="composite-focus-container flex items-center bg-background-light dark:bg-background-dark border border-border-light dark:border-border-dark rounded-lg overflow-hidden group focus-within:ring-1 focus-within:ring-primary focus-within:border-primary h-[42px]">
                                    <button type="button"
                                        class="w-10 h-full flex items-center justify-center text-text-secondary hover:text-primary hover:bg-gray-50 dark:hover:bg-white/5 transition-colors border-r border-border-light/50 dark:border-border-dark/50 disabled:opacity-30 disabled:cursor-not-allowed"
                                        (click)="form.get('installments')?.setValue((form.get('installments')?.value || 1) - 1)"
                                        [disabled]="isReadOnly">
                                        <span class="material-symbols-outlined text-lg">remove</span>
                                    </button>
                                    <input formControlName="installments" type="number" [min]="minInstallments"
                                        [max]="maxInstallments"
                                        class="composite-inner-input flex-1 bg-transparent border-none text-center font-bold text-sm focus:ring-0 py-0 h-full text-text-main dark:text-white" />
                                    <button type="button"
                                        class="w-10 h-full flex items-center justify-center text-text-secondary hover:text-primary hover:bg-gray-50 dark:hover:bg-white/5 transition-colors border-l border-border-light/50 dark:border-border-dark/50 disabled:opacity-30 disabled:cursor-not-allowed"
                                        (click)="form.get('installments')?.setValue((form.get('installments')?.value || 1) + 1)"
                                        [disabled]="isReadOnly">
                                        <span class="material-symbols-outlined text-lg">add</span>
                                    </button>
                                </div>
                            </div>

                            <div>
                                <label
                                    class="block text-[11px] font-bold text-text-secondary uppercase tracking-wider mb-2">Fecha
                                    Primer Pago</label>
                                <div class="relative">
                                    <input formControlName="firstPaymentDate"
                                        class="w-full px-4 py-2.5 rounded-lg bg-background-light dark:bg-background-dark border border-border-light dark:border-border-dark focus:ring-1 focus:ring-primary text-sm text-text-main dark:text-white"
                                        type="date" />
                                </div>
                            </div>
                        </div>
                    </div>


                    <!-- Summary (Teal) -->
                    <div class="bg-primary p-6 text-white">
                        <p class="text-[10px] font-extrabold uppercase tracking-[0.2em] mb-4 opacity-80">Resumen</p>

                        <div class="mb-6">
                            <p class="text-xs font-medium opacity-90 mb-1" *ngIf="form.get('financingEnabled')?.value">
                                Cuota Mensual Estimada</p>
                            <p class="text-xs font-medium opacity-90 mb-1" *ngIf="!form.get('financingEnabled')?.value">
                                Total a Pagar</p>

                            <div class="flex items-baseline gap-2">
                                <span class="text-sm font-bold">Gs.</span>
                                <span class="text-4xl font-extrabold tracking-tight">
                                    {{ (form.get('financingEnabled')?.value ? ((total -
                                    (form.get('initialPayment')?.value || 0)) / (form.get('installments')?.value ||
                                    1)) : total) | number:'1.0-0':'es-PY' }}
                                </span>
                            </div>
                        </div>

                        <div class="space-y-3 pt-4 border-t border-white/20">
                            <div class="flex justify-between items-center text-xs font-medium">
                                <span class="opacity-80">Costo Tratamiento</span>
                                <span class="font-bold">Gs. {{ subtotal | number:'1.0-0':'es-PY' }}</span>
                            </div>
                            <div class="flex justify-between items-center text-xs font-medium" *ngIf="discounts > 0">
                                <span class="opacity-80">Descuentos</span>
                                <span class="font-bold">- Gs. {{ discounts | number:'1.0-0':'es-PY' }}</span>
                            </div>
                            <div class="flex justify-between items-center text-xs font-medium"
                                *ngIf="form.get('financingEnabled')?.value">
                                <span class="opacity-80">Entrega Inicial</span>
                                <span class="font-bold">- Gs. {{ form.get('initialPayment')?.value || 0 |
                                    number:'1.0-0':'es-PY' }}</span>
                            </div>
                            <div class="flex justify-between items-center text-xs font-medium"
                                *ngIf="calculateInterest && financingInterest > 0">
                                <span class="opacity-80">Intereses</span>
                                <span class="font-bold">+ Gs. {{ financingInterest | number:'1.0-0':'es-PY'
                                    }}</span>
                            </div>

                            <div
                                class="flex justify-between items-center text-sm font-extrabold pt-2 mt-2 border-t border-white/10">
                                <span>Total a Financiar</span>
                                <span>Gs. {{ (form.get('financingEnabled')?.value ? (total -
                                    (form.get('initialPayment')?.value || 0)) : 0) | number:'1.0-0':'es-PY' }}</span>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Schedule -->
                <section
                    class="bg-surface-light dark:bg-surface-dark rounded-xl shadow-sm border border-border-light dark:border-border-dark overflow-hidden"
                    *ngIf="form.get('financingEnabled')?.value">
                    <div class="p-5 border-b border-border-light dark:border-border-dark flex items-center gap-2">
                        <span class="material-symbols-outlined text-primary text-lg">event_repeat</span>
                        <h3 class="text-sm font-bold uppercase tracking-wider text-text-main dark:text-white">
                            Cronograma de Pagos <span
                                class="text-[10px] text-text-secondary font-medium normal-case">(Informativo)</span>
                        </h3>
                    </div>
                    <div class="max-h-64 overflow-y-auto custom-scrollbar">
                        <table class="w-full text-[11px]">
                            <thead class="bg-gray-50 dark:bg-slate-800 sticky top-0">
                                <tr class="text-text-secondary uppercase font-bold">
                                    <th class="py-2 px-4 text-left">Cuota</th>
                                    <th class="py-2 px-4 text-left">Vencimiento</th>
                                    <th class="py-2 px-4 text-right">Monto</th>
                                </tr>
                            </thead>
                            <tbody class="divide-y divide-border-light dark:divide-border-dark">
                                <tr *ngFor="let row of paymentSchedule"
                                    class="hover:bg-gray-50/50 dark:hover:bg-slate-800/20">
                                    <td class="py-2.5 px-4 font-bold text-text-main dark:text-white">{{
                                        row.installment }}</td>
                                    <td class="py-2.5 px-4 text-text-secondary">{{ row.dueDate | date:'dd/MM/yyyy'
                                        }}</td>
                                    <td class="py-2.5 px-4 text-right font-bold text-emerald-600 dark:text-emerald-400">
                                        {{ row.amount | currency }}</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div
                        class="p-4 bg-gray-50 dark:bg-slate-800/50 border-t border-border-light dark:border-border-dark">
                        <p class="text-[9px] text-text-secondary leading-relaxed italic">
                            * Fechas estimadas basadas en la fecha actual. El cronograma final se generará al
                            confirmar el contrato.
                        </p>
                    </div>
                </section>
            </div>
        </form>
    </main>
    <!-- Sticky Content Footer -->
    <footer *ngIf="!isReadOnly"
        class="fixed bottom-0 right-0 left-0 md:left-64 h-16 flex items-center justify-end px-8 bg-surface-light dark:bg-surface-dark border-t border-border-light dark:border-border-dark z-20 shadow-lg">
        <div class="flex items-center gap-3">
            <button type="button" (click)="save(QuoteStatus.DRAFT)"
                class="px-6 py-2.5 rounded-lg text-text-secondary hover:text-text-main hover:bg-gray-50 dark:hover:bg-slate-800 transition-all text-sm font-bold flex items-center gap-2">
                Guardar Borrador
            </button>
            <button type="button" (click)="save(QuoteStatus.APPROVED)"
                [disabled]="form.invalid || items.length === 0 || isSaving"
                class="px-8 py-2.5 rounded-lg bg-primary text-text-main font-extrabold hover:bg-emerald-400 dark:hover:bg-emerald-600 transition-all shadow-md shadow-primary/10 flex items-center justify-center gap-2 text-sm disabled:opacity-50 disabled:cursor-not-allowed">
                <span class="material-symbols-outlined fill text-xl" *ngIf="!isSaving">check_circle</span>
                <span class="material-symbols-outlined text-xl animate-spin" *ngIf="isSaving">sync</span>
                Aceptar Presupuesto
            </button>
        </div>
    </footer>
</div>